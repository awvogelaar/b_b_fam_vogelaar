{% extends "booking/base.html" %}

{% block content %}
<div class="row">
  <div class="col-md-7">
    <h2>Reservering</h2>

    <div class="card mb-3">
      <div class="card-body">
        <h5 class="card-title">{{ reservation.family }}</h5>
        <p class="card-text mb-1">
          <strong>Periode:</strong>
          {{ reservation.start_date }} t/m {{ reservation.end_date }}
        </p>
        <p class="card-text mb-1">
          <strong>Prijs:</strong>
          {% if reservation.is_free %}
            <span class="badge bg-success">Gratis (familie-reservering)</span>
          {% else %}
            € {{ reservation.total_price }}
          {% endif %}
        </p>
        <p class="card-text mb-1">
          <strong>Check-in:</strong>
          {{ reservation.checked_in_at|date:"d-m-Y H:i"|default:"-" }}
        </p>
        <p class="card-text mb-1">
          <strong>Check-out:</strong>
          {{ reservation.checked_out_at|date:"d-m-Y H:i"|default:"-" }}
        </p>
        <p class="card-text">
          <small class="text-muted">
            Aangemaakt op {{ reservation.created_at|date:"d-m-Y H:i" }}
          </small>
        </p>
      </div>
    </div>

    {% if family and family == reservation.family or user.is_staff %}
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Check-in / Check-out</h5>
          <p class="card-text">
            Je kunt op de aankomstdag online inchecken en bij vertrek uitchecken.
          </p>

          {% if reservation.can_check_in %}
            <form method="post" action="{% url 'booking:reservation_checkin' reservation.pk %}" class="d-inline">
              {% csrf_token %}
              <button type="submit" class="btn btn-success">Nu inchecken</button>
            </form>
          {% endif %}

          {% if reservation.can_check_out %}
            <form method="post" action="{% url 'booking:reservation_checkout' reservation.pk %}" class="d-inline ms-2">
              {% csrf_token %}
              <button type="submit" class="btn btn-danger">Nu uitchecken</button>
            </form>
          {% endif %}

          {% if not reservation.can_check_in and not reservation.can_check_out %}
            <p class="text-muted mt-2">
              Op dit moment is er geen in- of uitcheckactie beschikbaar.
            </p>
          {% endif %}
        </div>
      </div>
    {% endif %}

    <div class="mt-3">
      <a href="{% url 'booking:reservation_list' %}" class="btn btn-link">
        ← Terug naar overzicht
      </a>
    </div>
  </div>
</div>
{% endblock %}